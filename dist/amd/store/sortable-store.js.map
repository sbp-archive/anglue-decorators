{"version":3,"sources":["src/store/sortable-store.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;QAEa,sBAAsB;AAsBpB,iBAtBF,sBAAsB,CAsBnB,KAAK,EAAE;kCAtBV,sBAAsB;;AAuB3B,gBAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,gBAAI,CAAC,OAAO,GAAG,IAAI,GAAG,EAAE,CAAC;SAC5B;;qBAzBQ,sBAAsB;;mBA2BjB,0BAAG;AACb,oBAAI,CAAC,MAAM,EAAE,CAAC;aACjB;;;mBAEK,kBAAG;AACL,oBAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;;;;;;AAC9B,yCAA0B,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,8HAAE;;;4BAAxC,GAAG;4BAAE,MAAM;;AACjB,8BAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;qBAC3B;;;;;;;;;;;;;;;;AACD,oBAAI,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;AAC1B,oBAAI,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;aACpC;;;mBAEW,sBAAC,QAAQ,EAAE;;;oBAEf,QAAQ,GAER,QAAQ,CAFR,QAAQ;oBACR,OAAO,GACP,QAAQ,CADR,OAAO;;AAGX,oBAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAC,KAAK,EAAK;AAClC,2BAAO,MAAK,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,QAAQ,EACtD,OAAO,CAAC,CAAC;iBAChB,CAAC,CAAC;;;;AAIH,oBAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;aAC/B;;;mBAEY,yBAAG,EAAE;;;mBAvDE,uBAAC,GAAG,EAAE;AACtB,gCAAe,aAAa,CAAC,GAAG,EAAE;AAC9B,mCAAe,EAAE,SAAS;iBAC7B,CAAC,CAAC;aACN;;;mBAEc,kBAAC,KAAK,EAAE;AACnB,oBAAI,QAAQ,GAAG,IAAI,sBAAsB,CAAC,KAAK,CAAC,CAAC;;AAEjD,sBAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE;AAC3B,4BAAQ,EAAE;AACN,6BAAK,EAAE,QAAQ;qBAClB;iBACJ,CAAC,CAAC;;AAEH,gCAAe,SAAS,CAAC,KAAK,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;AACpD,gCAAe,SAAS,CAAC,KAAK,EAAE,QAAQ,EAAE,cAAc,CAAC,CAAC;AAC1D,gCAAe,SAAS,CAAC,KAAK,EAAE,QAAQ,EAAE,eAAe,CAAC,CAAC;AAC3D,gCAAe,SAAS,CAAC,KAAK,EAAE,QAAQ,EAAE,gBAAgB,CAAC,CAAC;aAC/D;;;eApBQ,sBAAsB;;;YAAtB,sBAAsB,GAAtB,sBAAsB;yBA2DpB,sBAAsB","file":"src/store/sortable-store.js","sourcesContent":["import DecoratorUtils from '../utils';\n\nexport class SortableStoreDecorator {\n    static decorateClass(cls) {\n        DecoratorUtils.addInjections(cls, {\n            'filterService': '$filter'\n        });\n    }\n\n    static decorate(owner) {\n        var sortable = new SortableStoreDecorator(owner);\n\n        Object.defineProperties(owner, {\n            sortable: {\n                value: sortable\n            }\n        });\n\n        DecoratorUtils.intercept(owner, sortable, 'doSort');\n        DecoratorUtils.intercept(owner, sortable, 'onSortChange');\n        DecoratorUtils.intercept(owner, sortable, 'onItemsSorted');\n        DecoratorUtils.intercept(owner, sortable, 'onItemsChanged');\n    }\n\n    constructor(owner) {\n        this.owner = owner;\n        this.sorters = new Map();\n    }\n\n    onItemsChanged() {\n        this.doSort();\n    }\n\n    doSort() {\n        var sorted = this.owner.items;\n        for (let [key, sortFn] of this.sorters.entries()) {\n            sorted = sortFn(sorted);\n        }\n        this.owner.items = sorted;\n        this.owner.onItemsSorted(sorted);\n    }\n\n    onSortChange(sortInfo) {\n        var {\n            property,\n            reverse\n        } = sortInfo;\n\n        this.sorters.set('__sort', (items) => {\n            return this.owner.filterService('orderBy')(items, property,\n                reverse);\n        });\n\n        // We have to go through onItemsChanged so that other decorators can react\n        // to this as well.\n        this.owner.onItemsChanged();\n    }\n\n    onItemsSorted() {}\n}\n\nexport default SortableStoreDecorator;\n"]}
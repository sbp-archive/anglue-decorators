{"version":3,"sources":["src/store/crud-store.js"],"names":[],"mappings":"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","file":"src/store/crud-store.js","sourcesContent":["import utils from '../utils';\n\nexport class CrudStoreDecorator {\n    static decorate(owner) {\n        var crud        = new CrudStoreDecorator(owner);\n        var properties  = [\n            \"items\",\n            \"isLoaded\",\n            \"isLoading\",\n            \"isSaving\",\n            \"isEmpty\",\n            \"loadFailed\",\n            \"getFailed\",\n            \"createFailed\",\n            \"updateFailed\",\n            \"deleteFailed\"\n        ];\n\n        utils.addDecoratorProperties(owner, crud, properties);\n\n        Object.defineProperties(owner, {\n            crud: {\n                value: crud\n            },\n            hasDetails: {\n                value: crud.hasDetails.bind(crud)\n            },\n            getById: {\n                value: crud.getById.bind(crud)\n            },\n            onItemsChanged: {\n                configurable: true,\n                writable: true,\n                value: () => {}\n            }\n        });\n\n        utils.intercept(owner, crud, 'initialize');\n\n        utils.intercept(owner, crud, 'onLoadStarted');\n        utils.intercept(owner, crud, 'onCreateStarted');\n        utils.intercept(owner, crud, 'onGetStarted');\n        utils.intercept(owner, crud, 'onUpdateStarted');\n        utils.intercept(owner, crud, 'onDeleteStarted');\n\n        utils.intercept(owner, crud, 'onLoadCompleted');\n        utils.intercept(owner, crud, 'onCreateCompleted');\n        utils.intercept(owner, crud, 'onGetCompleted');\n        utils.intercept(owner, crud, 'onUpdateCompleted');\n        utils.intercept(owner, crud, 'onDeleteCompleted');\n\n        utils.intercept(owner, crud, 'onLoadFailed');\n        utils.intercept(owner, crud, 'onCreateFailed');\n        utils.intercept(owner, crud, 'onGetFailed');\n        utils.intercept(owner, crud, 'onUpdateFailed');\n        utils.intercept(owner, crud, 'onDeleteFailed');\n    }\n\n    constructor(owner) {\n        this.owner = owner;\n\n        this.initialize();\n    }\n\n    initialize() {\n        this.items = [];\n        this.isLoaded = false;\n        this.isLoading = false;\n        this.isSaving = false;\n\n        this.loadFailed = false;\n        this.getFailed = false;\n        this.createFailed = false;\n        this.updateFailed = false;\n        this.deleteFailed = false;\n\n        this.hasDetailsMap = {};\n    }\n\n\n    get isEmpty() {\n        return this.isLoaded && this.items.length === 0;\n    }\n\n    getById(id) {\n        return this.items.find((element) => {\n            return element.id === id;\n        });\n    }\n\n    hasDetails(id) {\n        return !!this.hasDetailsMap[id];\n    }\n\n    onLoadStarted() {\n        this.isLoading = true;\n        this.loadFailed = false;\n    }\n\n    onGetStarted() {\n        this.isLoading = true;\n        this.getFailed = false;\n    }\n\n    onUpdateStarted() {\n        this.isSaving = true;\n        this.updateFailed = false;\n    }\n\n    onCreateStarted() {\n        this.isSaving = true;\n        this.createFailed = false;\n    }\n\n    onDeleteStarted() {\n        this.isSaving = true;\n        this.deleteFailed = false;\n    }\n\n    onLoadCompleted(all) {\n        this.isLoading = false;\n        this.isLoaded = true;\n        this.items = all;\n        this.owner.onItemsChanged();\n    }\n\n    onGetCompleted(item) {\n        this.isLoading = false;\n        if (!this.getById(item.id)) {\n            this.items.push(item);\n        } else {\n            Object.assign(this.getById(item.id), item);\n        }\n        this.hasDetailsMap[item.id] = true;\n        this.owner.onItemsChanged();\n    }\n\n    onCreateCompleted(item) {\n        this.isSaving = false;\n        this.items.push(item);\n        this.owner.onItemsChanged();\n    }\n\n    onUpdateCompleted(item) {\n        this.isSaving = false;\n        Object.assign(this.getById(item.id), item);\n\n        if ('appActions' in this && 'publishSuccessMessage' in this.appActions) {\n            this.appActions.publishSuccessMessage(\n                'Update completed'\n            );\n        }\n\n        this.owner.onItemsChanged();\n    }\n\n    onDeleteCompleted(item) {\n        this.isSaving = false;\n        item = this.getById(item.id);\n        if (item) {\n            this.items.splice(this.items.indexOf(item), 1);\n        }\n        this.owner.onItemsChanged();\n    }\n\n    onLoadFailed(response) {\n        this.loadFailed = true;\n        this.onFailed(response);\n    }\n\n    onCreateFailed(response) {\n        this.createFailed = true;\n        this.onFailed(response);\n    }\n\n    onGetFailed(response) {\n        this.getFailed = true;\n        this.onFailed(response);\n    }\n\n    onUpdateFailed(response) {\n        this.updateFailed = true;\n        this.onFailed(response);\n    }\n\n    onDeleteFailed(response) {\n        this.deleteFailed = true;\n        this.onFailed(response);\n    }\n\n    onFailed(response) {\n        this.isLoading = false;\n        this.isSaving = false;\n\n        if ('appActions' in this && 'publishErrorMessage' in this.appActions) {\n            this.appActions.publishErrorMessage(\n                response.statusText,\n                JSON.stringify(response.data)\n            );\n        }\n\n        if ('onFailed' in this.owner) {\n            this.owner.onFailed(response);\n        }\n    }\n}\n\nexport default CrudStoreDecorator;\n"]}
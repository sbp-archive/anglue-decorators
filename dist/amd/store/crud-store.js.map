{"version":3,"sources":["src/store/crud-store.js"],"names":[],"mappings":"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","file":"src/store/crud-store.js","sourcesContent":["import DecoratorUtils from '../utils';\n\nexport class CrudStoreDecorator {\n    static decorate(owner) {\n        var crud = new CrudStoreDecorator(owner);\n\n        Object.defineProperties(owner, {\n            crud: {\n                value: crud\n            },\n            items: {\n                get: () => {\n                    return crud.items;\n                },\n                set: (items) => {\n                   crud.items = items;\n                }\n            },\n            isLoaded: {\n                get: () => {\n                    return crud.isLoaded;\n                },\n                set: (isLoaded) => {\n                    crud.isLoaded = isLoaded;\n                }\n            },\n            isLoading: {\n                get: () => {\n                    return crud.isLoading;\n                },\n                set: (isLoading) => {\n                    crud.isLoading = isLoading;\n                }\n            },\n            isSaving: {\n                get: () => {\n                    return crud.isSaving;\n                },\n                set: (isSaving) => {\n                    crud.isSaving = isSaving;\n                }\n            },\n            isEmpty: {\n                get: () => {\n                    return crud.isEmpty;\n                }\n            },\n            hasDetails: {\n                value: crud.hasDetails.bind(crud)\n            },\n            getById: {\n                value: crud.getById.bind(crud)\n            },\n            onItemsChanged: {\n                configurable: true,\n                writable: true,\n                value: () => {}\n            }\n        });\n\n        DecoratorUtils.intercept(owner, crud, 'onLoadStarted');\n        DecoratorUtils.intercept(owner, crud, 'onCreateStarted');\n        DecoratorUtils.intercept(owner, crud, 'onGetStarted');\n        DecoratorUtils.intercept(owner, crud, 'onUpdateStarted');\n        DecoratorUtils.intercept(owner, crud, 'onDeleteStarted');\n\n        DecoratorUtils.intercept(owner, crud, 'onLoadCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onCreateCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onGetCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onUpdateCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onDeleteCompleted');\n\n        DecoratorUtils.intercept(owner, crud, 'onLoadFailed');\n        DecoratorUtils.intercept(owner, crud, 'onCreateFailed');\n        DecoratorUtils.intercept(owner, crud, 'onGetFailed');\n        DecoratorUtils.intercept(owner, crud, 'onUpdateFailed');\n        DecoratorUtils.intercept(owner, crud, 'onDeleteFailed');\n    }\n\n    constructor(owner) {\n        this.owner = owner;\n\n        this.items = [];\n        this.isLoaded = false;\n        this.isLoading = false;\n        this.isSaving = false;\n\n        this.hasDetailsMap = {};\n    }\n\n    get isEmpty() {\n        return this.isLoaded && this.items.length === 0;\n    }\n\n    getById(id) {\n        return this.items.find((element) => {\n            return element.id === id;\n        });\n    }\n\n    hasDetails(id) {\n        return !!this.hasDetailsMap[id];\n    }\n\n    onLoadStarted() {\n        this.isLoading = true;\n    }\n\n    onGetStarted() {\n        this.isLoading = true;\n    }\n\n    onUpdateStarted() {\n        this.isSaving = true;\n    }\n\n    onCreateStarted() {\n        this.isSaving = true;\n    }\n\n    onDeleteStarted() {\n        this.isSaving = true;\n    }\n\n    onLoadCompleted(all) {\n        this.isLoading = false;\n        this.isLoaded = true;\n        this.items = all;\n        this.owner.onItemsChanged();\n    }\n\n    onGetCompleted(item) {\n        this.isLoading = false;\n        if (!this.getById(item.id)) {\n            this.items.push(item);\n        } else {\n            Object.assign(this.getById(item.id), item);\n        }\n        this.hasDetailsMap[item.id] = true;\n        this.owner.onItemsChanged();\n    }\n\n    onCreateCompleted(item) {\n        this.isSaving = false;\n        this.items.push(item);\n        this.owner.onItemsChanged();\n    }\n\n    onUpdateCompleted(item) {\n        this.isSaving = false;\n        Object.assign(this.getById(item.id), item);\n\n        if ('appActions' in this && 'publishSuccessMessage' in this.appActions) {\n            this.appActions.publishSuccessMessage(\n                'Update completed'\n            );\n        }\n\n        this.owner.onItemsChanged();\n    }\n\n    onDeleteCompleted(item) {\n        this.isSaving = false;\n        item = this.getById(item.id);\n        if (item) {\n            this.items.splice(this.items.indexOf(item), 1);\n        }\n        this.owner.onItemsChanged();\n    }\n\n    onLoadFailed(response) {\n        this.onFailed(response);\n    }\n\n    onCreateFailed(response) {\n        this.onFailed(response);\n    }\n\n    onGetFailed(response) {\n        this.onFailed(response);\n    }\n\n    onUpdateFailed(response) {\n        this.onFailed(response);\n    }\n\n    onDeleteFailed(response) {\n        this.onFailed(response);\n    }\n\n    onFailed(response) {\n        this.isLoading = false;\n        this.isSaving = false;\n\n        if ('appActions' in this && 'publishErrorMessage' in this.appActions) {\n            this.appActions.publishErrorMessage(\n                response.statusText,\n                JSON.stringify(response.data)\n            );\n        }\n\n        if ('onFailed' in this.owner) {\n            this.owner.onFailed(response);\n        }\n    }\n}\n\nexport default CrudStoreDecorator;\n"]}
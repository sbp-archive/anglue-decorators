{"version":3,"sources":["src/store/crud-store.js"],"names":[],"mappings":"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","file":"src/store/crud-store.js","sourcesContent":["import DecoratorUtils from '../utils';\n\nexport class CrudStoreDecorator {\n    static decorate(owner) {\n        var crud = new CrudStoreDecorator(owner);\n\n        Object.defineProperties(owner, {\n            crud: {\n                value: crud\n            },\n            items: {\n                get: () => {\n                    return crud.items;\n                },\n                set: (items) => {\n                   crud.items = items;\n                }\n            },\n            isLoaded: {\n                get: () => {\n                    return crud.isLoaded;\n                },\n                set: (isLoaded) => {\n                    crud.isLoaded = isLoaded;\n                }\n            },\n            isLoading: {\n                get: () => {\n                    return crud.isLoading;\n                },\n                set: (isLoading) => {\n                    crud.isLoading = isLoading;\n                }\n            },\n            isSaving: {\n                get: () => {\n                    return crud.isSaving;\n                },\n                set: (isSaving) => {\n                    crud.isSaving = isSaving;\n                }\n            },\n            isEmpty: {\n                get: () => {\n                    return crud.isEmpty;\n                }\n            },\n            hasDetails: {\n                value: crud.hasDetails.bind(crud)\n            },\n            getById: {\n                value: crud.getById.bind(crud)\n            },\n            onItemsChanged: {\n                configurable: true,\n                writable: true,\n                value: () => {}\n            }\n        });\n\n        DecoratorUtils.intercept(owner, crud, 'onLoadStarted');\n        DecoratorUtils.intercept(owner, crud, 'onCreateStarted');\n        DecoratorUtils.intercept(owner, crud, 'onGetStarted');\n        DecoratorUtils.intercept(owner, crud, 'onUpdateStarted');\n        DecoratorUtils.intercept(owner, crud, 'onDeleteStarted');\n\n        DecoratorUtils.intercept(owner, crud, 'onLoadCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onCreateCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onGetCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onUpdateCompleted');\n        DecoratorUtils.intercept(owner, crud, 'onDeleteCompleted');\n\n        DecoratorUtils.intercept(owner, crud, 'onLoadFailed');\n        DecoratorUtils.intercept(owner, crud, 'onCreateFailed');\n        DecoratorUtils.intercept(owner, crud, 'onGetFailed');\n        DecoratorUtils.intercept(owner, crud, 'onUpdateFailed');\n        DecoratorUtils.intercept(owner, crud, 'onDeleteFailed');\n    }\n\n    constructor(owner) {\n        this.owner = owner;\n\n        this.items = [];\n        this.isLoaded = false;\n        this.isLoading = false;\n        this.isSaving = false;\n\n        this.hasDetailsMap = {};\n    }\n\n    get isEmpty() {\n        return this.isLoaded && this.items.length === 0;\n    }\n\n    getById(id) {\n        return this.items.find((element) => {\n            return element.id === id;\n        });\n    }\n\n    hasDetails(id) {\n        return !!this.hasDetailsMap[id];\n    }\n\n    onLoadStarted() {\n        this.isLoading = true;\n    }\n\n    onGetStarted() {\n        this.isLoading = true;\n    }\n\n    onUpdateStarted() {\n        this.isSaving = true;\n    }\n\n    onCreateStarted() {\n        this.isSaving = true;\n    }\n\n    onDeleteStarted() {\n        this.isSaving = true;\n    }\n\n    onLoadCompleted(all) {\n        this.isLoading = false;\n        this.isLoaded = true;\n        this.items = all;\n        this.owner.onItemsChanged();\n    }\n\n    onGetCompleted(item) {\n        this.isLoading = false;\n        if (!this.getById(item.id)) {\n            this.items.push(item);\n        } else {\n            Object.assign(this.getById(item.id), item);\n        }\n        this.hasDetailsMap[item.id] = true;\n        this.owner.onItemsChanged();\n    }\n\n    onCreateCompleted(item) {\n        this.isSaving = false;\n        this.items.push(item);\n        this.owner.onItemsChanged();\n    }\n\n    onUpdateCompleted(item) {\n        this.isSaving = false;\n        Object.assign(this.getById(item.id), item);\n\n        if ('appActions' in this && 'publishSuccessMessage' in this.appActions) {\n            this.appActions.publishSuccessMessage(\n                'Update completed'\n            );\n        }\n\n        this.owner.onItemsChanged();\n    }\n\n    onDeleteCompleted(item) {\n        this.isSaving = false;\n        item = this.getById(item.id);\n        if (item) {\n            this.items.splice(this.items.indexOf(item), 1);\n        }\n        this.owner.onItemsChanged();\n    }\n\n    onLoadFailed(response) {\n        this.onFailed(response);\n    }\n\n    onCreateFailed(response) {\n        this.onFailed(response);\n    }\n\n    onGetFailed(response) {\n        this.onFailed(response);\n    }\n\n    onUpdateFailed(response) {\n        this.onFailed(response);\n    }\n\n    onDeleteFailed(response) {\n        this.onFailed(response);\n    }\n\n    onFailed(response) {\n        this.isLoading = false;\n        this.isSaving = false;\n\n        if ('appActions' in this && 'publishErrorMessage' in this.appActions) {\n            this.appActions.publishErrorMessage(\n                response.statusText,\n                JSON.stringify(response.data)\n            );\n        }\n\n        if ('onFailed' in this.owner) {\n            this.owner.onFailed(response);\n        }\n    }\n}\n\nexport default CrudStoreDecorator;\n"]}